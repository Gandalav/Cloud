<!DOCTYPE html>
<!-- saved from url=(0035)https://theproject.zone/writeup/3/3 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <link type="image/x-icon" rel="shortcut icon" href="https://theproject.zone/static/favicon.ico">
    <!--<link type="text/css" rel="stylesheet" href="/static/css/table_sort.css">-->
    <link type="text/css" rel="stylesheet" href="./P3.3_files/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="./P3.3_files/jquery.dataTables.min.css">
    <link type="text/css" rel="stylesheet" href="./P3.3_files/header.css">
    <link type="text/css" rel="stylesheet" href="./P3.3_files/defaultTheme.css">
    <link type="text/css" rel="stylesheet" href="./P3.3_files/datepicker.css">
    <link type="text/css" rel="stylesheet" href="./P3.3_files/bootstrap-editable.css">
    <title>15-319/619 Cloud Computing</title>
    
    
    
    
    
    <link type="text/css" rel="stylesheet" href="./P3.3_files/inside.base.css">

    <link type="text/css" rel="stylesheet" href="./P3.3_files/docs.min.css">


    <script type="text/javascript" src="./P3.3_files/jquery.min.js"></script>
    <script type="text/javascript" src="./P3.3_files/jquery.tablesorter.js"></script>
    <script type="text/javascript" src="./P3.3_files/jquery.dataTables.min.js"></script>
    <script type="text/javascript" src="./P3.3_files/jquery.fixedheadertable.js"></script>
    <script type="text/javascript" src="./P3.3_files/fnSetFilteringDelay.js"></script>
    <script type="text/javascript" src="./P3.3_files/datatableview.min.js"></script>
    <script type="text/javascript" src="./P3.3_files/bootstrap.min.js"></script>
    <script type="text/javascript" src="./P3.3_files/bootstrap-datepicker.js"></script>
    <script type="text/javascript" src="./P3.3_files/bootstrap-editable.min.js"></script>
<link rel="stylesheet" type="text/css" href="./P3.3_files/prettify.css"></head>

<body role="document" style="margin-bottom: 40px">

    <div id="base-container" class="container-fluid" style="padding-top: 49.888888835907px;">
    
    
    
    
    
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
   
        <div class="container-fluid">

            <div class="navbar-header" style="padding-bottom:40px">
               <a href="https://theproject.zone/home"><img src="./P3.3_files/TPZlogo_small_inverted.png"></a>
            </div>

            <div class="navbar-header pull-right">
                <a class="navbar-brand" href="https://theproject.zone/writeup/3/3#" onclick="return false;" style="margin-left: 0px;"><span class="label label-default" id="username-label">pgandala</span></a>
            </div>

            <div class="coll pull-right">
                <ul id="navbar" class="nav navbar-nav" style="font-weight:bold">
                    <li id="home"><a href="https://theproject.zone/home">Home</a></li>

                    
                        
                        <li id="project0" class="dropdown">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">Primer
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/0/1">Project Primer</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                        <li id="project1" class="dropdown">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">Project 1
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/1/1">1.1 Sequential Analysis</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/1/2">1.2 Using Amazon's Elastic MapReduce</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                        <li id="project2" class="dropdown">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">Project 2
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/2/1">2.1 Introduction to AWS APIs</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/2/2">2.2 Load Balancing and AutoScaling</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/2/3">2.3 Advanced Scaling Concepts</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                        <li id="project3" class="dropdown active">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">Project 3
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/3/1">3.1 Files v/s Databases</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/3/2">3.2 Partitioning and Replication</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="./P3.3_files/P3.3.html">3.3 Database-as-a-Service</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/3/4">3.4 Cloud Data Warehousing</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/3/5">3.5 Consistency in Distributed Key-Value Stores</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                        <li id="project4" class="dropdown">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">Project 4
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/4/1">4.1 MapReduce Programming using YARN</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/4/2">4.2 Iterative Programming using Apache Spark</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/4/3">4.3 Graph Programming using GraphLab</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                        <li id="project5" class="dropdown">
                            <a href="https://theproject.zone/writeup/3/3#" data-toggle="dropdown" class="dropdown-toggle">15619 Project
                            
                                <b class="caret"></b>
                            
                            </a>
                            
                            <ul class="dropdown-menu">
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/1">Phase 1</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/2">Phase 1 Report</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/3">Phase 2</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/4">Phase 2 Live Test (MySQL)</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/5">Phase 2 Live Test (HBase)</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/6">Phase 2 Report</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/7">Phase 3</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/9">Phase 3 Live Test</a></li>
                                        
                                    
                                
                                    
                                        
                                        
                                        
                                        <li><a class="active" href="https://theproject.zone/writeup/5/10">Phase 3 Report</a></li>
                                        
                                    
                                
                            </ul>
                            
                        </li>
                        
                    
                
                    
                    <li id="grade"><a class="active" href="https://theproject.zone/grade/">Grade Book</a></li>
                    <li id="profile"><a href="https://theproject.zone/profile">Profile</a></li>
                    <li id="logout"><a href="https://theproject.zone/log_out">Log Out</a></li>
                </ul>
            </div>
        </div>
    </nav>


    <div class="container">

        <div class="row">

        <div class="col-md-6">
            <h2>3.3 Database-as-a-Service</h2>
        </div>
        
        
        <div class="col-md-6 pull-down">
            <div class="btn-group pull-right" style="margin-bottom: 10px">
                <a class="btn btn-default btn-primary" href="https://theproject.zone/writeup/3/3/" id="nav_writeup">Writeup</a>

                

                

                <a class="btn btn-default" href="https://theproject.zone/submissions/3/3/" id="nav_submissions">Submissions</a>
                <a class="btn btn-default" href="https://theproject.zone/scoreboard/3/3/" id="nav_score_board">ScoreBoard</a>
            </div>
        </div>
        
        
        </div>

        <table class="table table-striped table-bordered table-condensed prettyBorder">
        <thead>
            <tr>
                <th>Phase</th>
                <th>Open</th>
                <th>Deadline</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>3.3 Database-as-a-Service</td>
                <td>Mar. 16, 2015 00:01</td>
                <td>Mar. 22, 2015 23:59</td>
            </tr>
        </tbody>
        </table>
        
        

        <hr>
        

<style>
  img{
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 10px;
  }
  small.caption {
  display: block;
  text-align: center;
  margin-bottom: 4em;
  }
  small.tcaption {
  display: block;
  text-align: center;
  }
  iframe {
  display: block;
  margin-left: auto;
  margin-right: auto;
  margin-bottom: 30px;
  }
  .bs-callout-task {
  background-color: #ffffff;
  border-left-color: green;
  }
  .bs-callout-task h4,
  .bs-callout-task a.alert-link {
  color: green;
  }
  .bs-callout-learning {
  background-color: #ffffff;
  border-left-color: purple;
  }
  .bs-callout-learning h4,
  .bs-callout-learning a.alert-link {
  color: purple;
  }
  .bs-docs-sidebar.affix {
  position: fixed;
  top: 25x;
  }
</style>

<div id="writeup-content" class="row">
<div class="col-md-3" role="complementary">
  <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix-top" style="top:120px">
    <!-- Inline CSS Hack for Display -->
    <ul class="nav bs-docs-sidenav">
      <li>
        <a href="https://theproject.zone/writeup/3/3#intro">Introduction</a>
        <ul class="nav">
          <li><a href="https://theproject.zone/writeup/3/3#dbaas">Database-as-a-Service</a></li>
        </ul>
      </li>
       <li>
        <a href="https://theproject.zone/writeup/3/3#architecture">Architecture</a>
        <ul class="nav">
        </ul>
      </li>
      <li>
        <a href="https://theproject.zone/writeup/3/3#timeline">Build Your Own Timeline</a>
        <ul class="nav">
        </ul>
      </li>
      <li>
        <a href="https://theproject.zone/writeup/3/3#tasks">Tasks to Complete</a>
        <ul class="nav">
          <li><a href="https://theproject.zone/writeup/3/3#step0">Step 0: Get Started!</a></li>
          <li><a href="https://theproject.zone/writeup/3/3#step1">Step 1: User Information (RDS)</a></li>
          <li><a href="https://theproject.zone/writeup/3/3#step2">Step 2: Friends Relationship (HBase)</a></li>
          <li><a href="https://theproject.zone/writeup/3/3#step3">Step 3: Profile Images (DynamoDB)</a></li>
          <li><a href="https://theproject.zone/writeup/3/3#step4">Step 4: Putting All Things Together</a></li>
        </ul>
      </li>
      <li>
        <a href="https://theproject.zone/writeup/3/3#grading">Grading</a>
        <ul class="nav">
          <li><a href="https://theproject.zone/writeup/3/3#penalties">Grading Penalties</a></li>
        </ul>
      </li>
    </ul>
    <a class="back-to-top" href="https://theproject.zone/writeup/3/3#top">
    Back to top
    </a>
  </nav>
</div>
<div class="col-md-9" role="main">
<div class="bs-docs-section">
  <h1 id="intro" class="page-header">Introduction</h1>
  <div class="bs-callout bs-callout-learning">
    <h4>Learning Objectives</h4>
    <p>This project will encompass the following learning objectives:</p>
    <ol>
      <li>Explore the usage of various provisioned database services in AWS.</li>
      <li>Experience loading data into and querying  RDS, DynamoDB and HBase.</li>
      <li>Developing a social networking image timeline using heterogeneous backends such as RDS, DynamoDB, HBase and S3.</li>
    </ol>
  </div>
  <h3 id="dbaas">Database-as-a-Service (DBaaS)</h3>
  <p>Database-as-a-Service is provided by cloud operators, who are fully responsible for managing the databases that support applications, without the application developers performing traditional database administration functions. The database can seamlessly scale and is maintained, upgraded, backed-up by the cloud provider. DBaaSes silently and transparently handle server failure, without impacting the application developer in any way. The role of a database administrator becomes less essential in this scenario.</p>
  <p>In this project module we will introduce you to database services on AWS. These services enable users to rapidly configure and deploy a database system without having to manually launch and configure instances and database software. In Project 3.3, you will explore Amazon's Relational Database Service (RDS), and a NoSQL database service (Amazon's DynamoDB). You will continue to explore HBase on EMR.</p>
  <h4><b>Amazon RDS</b></h4>
  <p><a href="http://aws.amazon.com/rds/">RDS</a> is an AWS service that allows users to configure and deploy easy-to-configure relational databases. RDS provides users with a configured relational database instance of their choosing (MySQL, Oracle, MS SQL server, and others), running on specifically tuned database instance types, with optional performance enhancements such as provisioned IOPS storage. The main advantage of RDS is that the service will manage the database on behalf of the user, including the upgrading of the database software and backups, during user-specified maintenance windows. The main disadvantage of using RDS is that, you do not have fine-grained control over the deployment of the database. You can further watch <a href="https://www.youtube.com/watch?v=Kz1zmyHw9G0">this video</a> which explains the functionality of RDS in detail.</p>
  <h4><b>Amazon DynamoDB</b></h4>
  <p><a href="http://aws.amazon.com/dynamodb/">Amazon's DynamoDB</a> is a NoSQL distributed database, similar to HBase and Cassandra. As a NoSQL Database, DynamoDB's functionality is limited compared to SQL databases- this is to ensure consistently high performance at very large scales. As an application developer using DynamoDB, your only parameters are how much read and write throughput your application needs- you do not have to worry about scaling, tuning, replication, etc. You can watch <a href="https://www.youtube.com/watch?v=2qjwub2jzfA">this video</a> to learn more about DynamoDB.</p>
  <div class="bs-callout bs-callout-danger">
    <h4>Warning</h4>
    <p>Some the services you will be using for this project are expensive when left running or configured incorrectly. Please plan ahead and pay special attention to the instructions before provisioning any resources.</p>
  </div>
  <div class="bs-callout bs-callout-warning">
    <h4>Resource Tagging</h4>
    <p>For this project, assign the tag with <code>Key: Project</code> and <code>Value: 3.3</code> for all <b>EC2 instances, RDS instances and HBase cluster instances. There is no need to tag DynamoDB, but ensure that you are tagging the EMR cluster that is created for loading the data into DynamoDB.</b></p>
  </div>
</div>
<div class="bs-docs-section">
<h1 id="timeline">Build Your Own Social Network Image Timeline</h1>
<p>Three weeks after you were promoted to work on the backend storage systems of Carnegie Records (CR), the company has decided to make the music content delivery service more social for its users. Your team has been given the task of building the first prototype. Since your manager is extremely happy with your work in the past three weeks, she has decided to assign you this important task. During your last team meeting, it was decided that the first step in making CR more social is building an image gallery timeline for its users. You have been asked to use the various database services in AWS to build this social network image timeline. You have been given a budget of $20 to complete this task. The frontend engineer in your team has provided a template of the social network image timeline and now you are responsible for implementing the backend.</p>
<img src="./P3.3_files/timeline.png" width="90%" height="50%">
<h4>
  <small class="caption">
    <p>Figure 1: Example Timeline</p>
  </small>
</h4>
<h1 id="architecture">Architecture</h1>
 <p>For this project, your team has decided to use the web service structure shown below. </p>
  <img src="./P3.3_files/general_architecture.png" style="border: 1px solid;" width="90%" height="70%">
  <h4>
    <small class="caption">
      <p>Figure 2: General Architecture</p>
    </small>
  </h4>
  <p>As shown in the figure, the backend data stores include a "user information store" for authentication data, a "friendship information store" to manage social relations, a "profile image information store" to fetch the details of the images of a user, and an "image store" to get the actual images to be shown in the social network image timeline. In this project you need to load three different datasets into three different databases (RDS, HBase, DynamoDB) and query the databases for correct answers in JSON format according to the HTTP requests received. All datasets are provided in CSV (comma-separated values) format and you may need to modify the dataset in order to make it best fit the database.</p>
  <h4>

  </h4><h1 id="tasks">Tasks to Complete</h1>
  <h4 id="step0"><b>Step 0: Get Started!</b></h4>
  <p>Your team plans to build a web service with the structure shown in Figure 3. The frontend instance receives the requests from client and forwards it to the backend server instance after processing. Then the backend server instance will connect to the heterogeneous backends with RDS, HBase, DynamoDB and S3 to fetch useful data and send it back to the frontend. Finally, the frontend will render the data and display it to the client (usually a browser) as a image timeline.</p>
<p></p>
  <img src="./P3.3_files/Fig2.jpg" style="border: 1px solid;" width="70%" height="50%">
  <h4>
    <small class="caption">
      <p>Figure 3: Web Service Structure</p>
    </small>
  </h4>
  <p>Since your partner has already finished developing the frontend, you only need to implement the backend server and set up the databases. You need to load three different datasets into three different databases (RDS, HBase, DynamoDB) and query the databases for correct answers in JSON format according to the HTTP requests received. All datasets are provided in CSV (comma-separated values) format and you may need to modify the dataset in order to make it best fit the database.</p>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>Name</th>
        <th>AMI</th>
        <th>Instance Type</th>
        <th>Security Group</th>
      </tr>
    </thead>
    <tbody><tr>
      <td>Frontend instance</td>
      <td>ami-e26a498a</td>
      <td>m3.large</td>
      <td>all traffic</td>
    </tr>
    <tr>
      <td>Backend server instance</td>
      <td>ami-1420037c</td>
      <td>m3.large</td>
      <td>all traffic</td>
    </tr>
  </tbody></table>
  <h4><small class="tcaption"><p>Table 1: AMI</p></small></h4>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>Name</th>
        <th>Stored In</th>
        <th>Description</th>
        <th>Location</th>
      </tr>
    </thead>
    <tbody><tr>
      <td>user.csv</td>
      <td>RDS</td>
      <td>user information <userid, password,="" name=""></userid,></td>
      <td>/home/ubuntu/user.csv</td>
    </tr>
    <tr>
      <td>links.csv</td>
      <td>HBase</td>
      <td>user1 is following user2 <user1, user2=""></user1,></td>
      <td>s3://soundrrr/links.csv</td>
    </tr>
    <tr>
      <td>images.csv</td>
      <td>DynamoDB</td>
      <td>profile images <userid, created_date,="" image_url=""></userid,></td>
      <td>s3://cloud.public/images.csv</td>
    </tr>
  </tbody></table>
  <h4><small class="tcaption"><p>Table 2: Dataset Information <b>(Stored on Backend Server Instance)</b></p></small></h4>
  <ol>
    <li>Launch one <b>frontend instance</b></li>
    <li>ssh to the frontend instance and run following command to start frontend service.<br>
      <code>/home/ubuntu/wildfly-8.2.0.Final/bin/standalone.sh</code><br>
      Alternatively, you can run it in the background using<br>
      <code>nohup /home/ubuntu/wildfly-8.2.0.Final/bin/standalone.sh &amp;</code>
    </li>
    <li>
      Go to http://frontend-public-dns:8080/p3-3.3/step1 in your browser. If you can see the following page, your frontend is correctly launched. <br><b>NOTE: The bootstrap process of the frontend instance takes around 3 minutes.</b>
      <img src="./P3.3_files/step1.png" width="70%" height="50%">
      <h4>
        <small class="caption">
          <p>Figure 4: Step 1- Testing Page</p>
        </small>
      </h4>
    </li>
    <li>Launch one <b>backend server instance</b>. On the backend server instance, you will implement the web server which receives the request from the frontend instance and fetch data from the backend databases. The frontend instance is used for rendering and displaying your response. Do not change any code or configuration on the frontend instance.</li>
    <li>SSH into the backend server instance using ubuntu as the user name and your own pem file.</li>
    <li>Go to the Project3_3 folder in the ubuntu home directory. We use <a href="http://maven.apache.org/">Apache Maven</a> to manage this project's build, reporting and documentation. Maven is a software project management and comprehension tool. It dynamically downloads Java libraries and Maven plug-ins from one or more repositories such as the Maven 2 Central Repository, and stores them in a local cache. Installing a library or plug-in can be as easy as search your desired repository <a href="http://mvnrepository.com/">here</a>, and then copy the dependency into your pom.xml. Then execute <code>mvn clean install</code>.</li>
    <li>Your task is to complete <b>MiniSite.java</b> which can be found at <code>/home/ubuntu/Project3_3/src/main/java/cc/cmu/edu/minisite/MiniSite.java</code> (currently the web application is not connected to any backend databse).</li>
    <li>You can find the <a href="http://maven.apache.org/pom.html">project object model (POM) file</a> pom.xml which contains information about the project and configuration details used by Maven to build the project. All the necessary libraries are already included in pom.xml.</li>
    <li>In the folder Project3_3 you will also find the executable submitter, references and several other helper files.</li>
    <li>Now, before working on your project, try building the project using command:<br>
      <code>mvn clean install</code><br>
      Then launch your server:<br>
      <code>mvn exec:java</code>
    </li>
    <li>
      Go to <code>http://frontend-public-dns:8080/p3-3.3/step1?id=1&amp;pwd=MA0UWFHING9W&amp;dns=backend-server-public-dns</code> in  your browser and verify that you can see a dummy response.<br>
      <img src="./P3.3_files/step1dummy.png" width="70%" height="50%">
      <h4>
        <small class="caption">
          <p>Figure 5: Step 1- Dummy Response</p>
        </small>
      </h4>
    </li>
    <li>
      Open MiniSite.java under <code>/home/ubuntu/Project3_3/src/main/java/cc/cmu/edu/minisite/</code> directory. The server uses the <a href="http://undertow.io/">Undertow</a> framework. Undertow is a flexible performant web server written in Java. It has a composition-based architecture that allows you to build a web server by combining small single-purpose handlers. This gives you the flexibility to choose between a full Java EE servlet 3.1 container, or a low level non-blocking handler, or anything in between. <br>Note that:
      <ul>
        <li>Requests to the frontend are in the following format <br><code>http://frontend-public-dns:8080/p3-3.3/step#?id=XX&amp;pwd=XXX&amp;dns=backend-server-public-dns</code><br>It will be forwarded to the server in the following format<br><code>http://server-public-dns:8080/step#?id=XX&amp;pwd=XXX</code><br>Note the difference in the path and the parameters.</li>
        <li>When implementing a server you must deal with HTTP requests and responses. In Undertow, the HttpServerExchange class describes the HTTP server request/response exchange. An instance of this class (exchange in this example) is constructed as soon as the request headers are fully parsed. The signature below shows the <b>Request handler function</b>.<br>
            <code>public void handleRequest(HttpServerExchange exchange)</code><br>
             Useful methods of HttpServerExchange:<br>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>Method</th>
        <th>Modifier and Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody><tr>
      <td>getRequestPath()</td>
      <td>String</td>
      <td>Return the request path</td>
    </tr>
    <tr>
      <td>getQueryParameters()</td>
      <td>Map&lt;String,Deque&lt;String&gt;&gt;</td>
      <td>Return a multiple map of query parameters</td>
    </tr>
    <tr>
      <td>getResponseSender()</td>
      <td>Sender</td>
      <td>Get the response sender</td>
    </tr>
  </tbody></table>
        <h4><small class="tcaption"><p>Table 3: Useful methods</p></small></h4>
        A summary of all the methods of the HttpServerExchange class can be found <a href="http://repository.jboss.org/nexus/content/unzip/unzip/io/undertow/undertow-core/1.0.14.Final/undertow-core-1.0.14.Final-javadoc.jar-unzip/io/undertow/server/HttpServerExchange.html">here</a>.<br>
        </li>
        <li>Your response should be in JSON format and an example is provided in MiniSite.java. The detailed requirements for each query are explained at the end of each step. Learn more about JSON in Java <a href="http://www.json.org/java/">here</a>.
        </li>
        <li>Now that you have an idea about the structure of this project, you can complete the following steps to build your own image timeline!
        </li>
      </ul>
    </li>
  </ol>
  <h4 id="step1"><b>Step 1: user authentication and fetching user information. (RDS)</b></h4>
  <p>The first task in building the Timeline is authenticating users and fetching some basic information about them. Your team decided to use MySQL as the backend database for this step. The database service you will be using for this is RDS. When a user logs in to the website with &lt;userid&gt; and &lt;password&gt;, the backend server needs to validate the login information using the RDS. If &lt;userid&gt; and &lt;password&gt; are valid for a particular user, the user's &lt;name&gt; should be displayed on the page. Otherwise, it should be shown as "Unauthorized". In this project, we will use a simple Http request <code>GET /step1?id=XX&amp;pwd=XXX</code> to simulate this process. To begin, you need to provision an RDS-managed MySQL database and store the user information in it.</p>
  <p>The dataset you are going to deal with in Step 1 is user.csv. This dataset contains three fields separated by commas: userid, password, and name. user.csv briefly describes users' account information, their userid, password to the account, and name.</p>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          Name
        </th>
        <th>
          Stored In
        </th>
        <th>
          Description
        </th>
        <th>
          Location
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>user.csv</td>
      <td>RDS</td>
      <td>user information <userid, password,="" name=""></userid,></td>
      <td>/home/ubuntu/user.csv</td>
    </tr>
  </tbody></table>
  <h4>
    <small class="tcaption">
      <p>Table 4: RDS Information</p>
    </small>
  </h4>
  <h5>Setting up RDS</h5>
  <ol>
    <li>
      Log on to the AWS console and navigate to the RDS home page.
    </li>
    <li>
      Launch a new MySQL database instance with the following settings:
      <ol>
        <li>
          Select Yes for Production instance.
        </li>
        <li>
          DB Instance Class - <b>db.m3.medium</b>.
        </li>
        <li>
          Multi AZ Deployment - No.
        </li>
        <li>
          Storage Type - Provisioned IOPS SSD.
        </li>
        <li>
          Allocated Storage - 100GB.
        </li>
        <li>
          Provisioned IOPS - 1000.
        </li>
        <li>
          Ensure that the <b>security group </b>allows port <b>3306</b>.
        </li>
      </ol>
    </li><li>
      Note down your DB’s <b>endpoint</b> URL, which indicates the DB's <b>host address</b> and <b>port</b>.
    </li>
    <li>
      Create a table with the appropriate schema for user information (Hint: Look at user.csv to get an idea for the schema).
    </li>
    <li>
      Load <b>user.csv</b> into RDS. Connect to RDS in MiniSite.java. JDBC is already installed and imported.<br>
      You need to rebuild your project by executing <code>mvn clean install</code> in the Project3_3 directory each time your code has been changed.<br>
      You can start your Undertow web server, using <code>mvn exec:java</code>. Alternatively, you can run it in background using <code>nohup mvn exec:java &amp;</code>
    </li>
    <li>
      Read more about JDBC <a href="http://www.tutorialspoint.com/jdbc/jdbc-sample-code.htm">here</a>.
    </li>
  </ol>
  <br>
  <h5>Request and Response of Your Server</h5>
  <h6>
    Request Format (received by server)
  </h6>
  <pre>GET /step1?id=&lt;userid&gt;&amp;pwd=&lt;password&gt;
</pre>
  <h6>
    Response Value (server sends to frontend)
  </h6>
  <pre>If the &lt;userid&gt; and &lt;password&gt; is a pair, set username as the response value. Otherwise, set as "Unauthorized".
</pre>
  <h6>
    Response Format
  </h6>
  <pre>JSONObject response = new JSONObject();
response.put("name", <b>responseValue</b>);
String content = "returnRes("+mapper.writeValueAsString(response)+")";
sender.send(content);
</pre>
  <p>
    You can use your frontend instance to check your answer.
  </p>
  <h6>
    Example Query:
  </h6>
  <pre>http://frontend-public-dns:8080/p3-3.3/step1?id=1&amp;pwd=MA0UWFHING9W&amp;dns=backend-server-public-dns
</pre>
  <h6>
    Answer
  </h6>
  <pre>Aaliyah
</pre>
  <h4 id="step2"><b>Step 2: Friends' Relationship (HBase)</b></h4>
  <p>Now that you have authenticated the user, you are expected to develop the user's list of friends in order to build the timeline for the user. In order to achieve this, you will be using HBase. Similar to P3.2, you will be using Amazon's Elastic MapReduce (EMR) to provision an HBase cluster and store the "friend relationship" information.</p>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          Name
        </th>
        <th>
          Stored In
        </th>
        <th>
          Description
        </th>
        <th>
          Location
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>links.csv</td>
      <td>HBase</td>
      <td>user1 is following user2 (user2 is followed by user1) <user1, user2=""></user1,></td>
      <td>s3://soundrrr/links.csv</td>
    </tr>
  </tbody></table>
  <h4>
    <small class="tcaption">
      <p>Table 5: HBase Information</p>
    </small>
  </h4>
  <p>Note: All the directory, file and table names, which are marked as <b>bold</b> should be replaced by your own names</p>
  <ol>
    <li>
      Provision an HBase cluster using EMR as you learned in P3.2. The instance type to be used for HBase is <b>m1.large</b> and the number of core instances is <b>1</b>. Also, you should follow some key configurations given below:
      <ul>
        <li>
          Choose AMI version 2.4.2 (Hadoop version 1.0.3).
        </li>
        <li>
          Remove any existing services such as Pig and Hive and choose to install HBase version 0.92.
        </li>
        <li>
          Use <b>the same subnet</b> as your frontend instance (you need to connect to the HBase master using its private ip).
        </li>
        <li>
          Modify the Security Group to enable <b>all traffic</b>.
        </li>
        <li>
          Specify a key-pair to be able to SSH to the individual instances. Note that the username to use while SSHing to these instances is <b>hadoop</b>.
        </li>
        <li>
          Do not forget to set a tag that will be automatically propagated to the individual instances in the cluster.
        </li>
        <li>
          Enable "termination protection" and "keep-alive" for your cluster.
        </li>
      </ul>
    </li><li>
      SSH to the HBase master node. You can use the method learned in P3.2 to check each node’s status.
    </li>
    <li>
      Design your own schema and load the <b>links.csv</b> into HBase (Hint: You may want to preprocess the file to fit the schema better). Try to leverage the features that make HBase unique for this purpose.
      <ul>
        <li>
          Recall that the file links.csv has two columns <user1, user2=""> where user1 is following user2 (user2 is a friend of user1).
        </user1,></li>
        <li>
          Each user can be a friend of multiple users, and each user can have multiple friends.
        </li>
        <li>
          Learn more about HBase <a href="http://hbase.apache.org/0.94/book.html">here</a>.
        </li>
      </ul>
    </li><li>
      Create a table for friend relationship (following/followed).
      <ul>
        <li>
              Read more about HBase Shell commands <a href="http://wiki.apache.org/hadoop/Hbase/Shell">here</a>.
            </li>
          </ul></li></ol>
      
    <li>
      Load data into HBase.
    </li>
    
    <p>HBase includes several methods of loading data into tables. We will introduce the <b>Bulk Load</b> method in this project.</p>
    <p>The most straightforward method is to either use the <b>TableOutputFormat class</b> from a MapReduce job, or use the normal <b>client APIs</b>; However, these are not always the most efficient methods because these APIs cannot handle bulk loading.</p>
    <p><b>Bulk</b> Importing bypasses the HBase API and writes contents, which are properly formatted as HBase data files – <b>HFiles</b>, directly to the file system. Analyzing HBase data with MapReduce requires custom coding.</p>
    <p>Using bulk load will use less CPU and network resources than simply using the HBase API. ImportTsv is a custom MapReduce application that will by default load data in TSV (Tab Separated Value) format into HBase. By adding optional arguments, <b>importTsv</b> can work for other format files including CSV.</p>
    <ol>
      <li>Upload dataset (in TSV/CSV format) to HDFS (Hadoop Distributed File System)</li>
      <p>The File System (FS) shell includes various shell-like commands that directly interact with the Hadoop Distributed File System (HDFS) as well as other file systems that Hadoop supports, such as Local FS, HFTP FS, S3 FS, and others. The FS shell is invoked by:</p>
      <code>bin/hadoop fs &lt;args&gt;</code>
      <p>
        Run the following commands to complete this task.<br>
        <code>hadoop fs -mkdir <b>/data</b></code><br>
        <code>hadoop fs -put <b>localFileSystemPath/example.csv /data/</b></code>
      </p>
      
      <li>
        To check if the file is successfully uploaded, using following command.<br>
        <code>hadoop fs -ls <b>/data</b></code>
        Read more about hadoop fs commands <a href="http://hadoop.apache.org/docs/current/hadoop-project-dist/hadoop-common/FileSystemShell.html">here</a>.
      </li>
      <li>
        Use <b>importTsv</b> to prepare HFiles for HBase table <b>t1</b>. Run the following command to transform the data from the file example.csv in HDFS to StoreFiles and store at a relative path specified by Dimporttsv.bulk.outputHbase<br>
        <code>bin/hbase org.apache.hadoop.hbase.mapreduce.ImportTsv -Dimporttsv.bulk.output=<b>example/storeDataFileOutput</b> -Dimporttsv.columns="HBASE_ROW_KEY,<b>column_family_name</b>" -Dimporttsv.separator="," <b>t1 /data/example.csv</b></code><br>
        You can see the progress of the MapReduce job if it's successfully launched
        <img src="./P3.3_files/mappers.png" width="90%" height="50%">
        <h4>
          <small class="caption">
            <p>Figure 6: Map Reduce job status</p>
          </small>
        </h4>
        <p>Check last Map output records (last line of the output) to verify your result. Generally speaking, it equals to number of records in your dataset.</p>
        <img src="./P3.3_files/mapredstatus.png" width="90%" height="50%">
        <h4>
          <small class="caption">
            <p>Figure 7: Job Information</p>
          </small>
        </h4>
        <p>Hint: If your dataset is in tsv format, you can omit the <b>.separator</b> option.
          As with any other MapReduce job, the output directory should not exist before running.
        </p>
      </li>
      <li>
        Use the <b>completebulkload</b> tool to complete the upload of data. Run the following to upload the data from the HFiles located at <b>example/storeDataFileOutput</b> to the HBase table <b>t1</b><br>
        <code>bin/hbase org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles <b>example/storeDataFileOutput t1</b></code>
      </li>
      <li>
        To verify that the data is successfully loaded, open the HBase shell and scan the table.<br>
        <code>scan '<b>t1</b>'</code><br>
        Use <code>Ctrl-C</code> to stop the scan.<br>
        Note: Your loading method is not restricted in this project. Feel free to explore use TableOutputFormat class from a MapReduce job, HBase client APIs and other possible methods.
      </li>
    </ol>
    <li>
      Connect to HBase in MiniSite.java.
      <ul>
        <li>
          HBase and Hadoop libraries are already installed and imported.
        </li>
        <li>
          Use <b>private ip address</b> of master node to connect to HBase.
        </li>
        <li>
          Read more about HBase APIs <a href="http://archive.cloudera.com/cdh4/cdh/4/hbase-0.92.1-cdh4.0.0/apidocs/index.html">here</a>.
        </li>
      </ul>
    </li>
    <br>
    <h5>
      Request and Response of Your Server.
    </h5>
    <h6>
      Request Format.
    </h6>
    <pre>GET /step2?id=&lt;userid&gt;
</pre>
    <h6>
      Response Value.
    </h6>
    <pre>Return &lt;userid&gt; of all people that is followed by the person &lt;userid&gt; in <b>Alphabetical Order (NOT Numeric Order)</b>
</pre>
    <h6>
      Response Format.
    </h6>
    <pre>JSONObject response = new JSONObject();
JSONArray friends = new JSONArray();
JSONObject friend1 = new JSONObject();
JSONObject friend2 = new JSONObject();
friend1.put("userid", id1);
friend2.put("userid", id2);
friends.add(friend1);
friends.add(friend2);
response.put("friends", friends);
String content = "returnRes("+mapper.writeValueAsString(response)+")";
sender.send(content);
</pre>
    <p>Once you are done, when querying the frontend with a userid, a list of FriendIDs should be shown as below.<br>
      <img src="./P3.3_files/friends_list.png" width="70%" height="50%">
    </p><h4>
      <small class="caption">
        <p>Figure 8: List of Friends</p>
      </small>
    </h4>
    <p></p>
     
    
  
  <h4 id="step3"><b>Step 3: Images for the timeline (DynamoDB)</b></h4>
  <p>Now that you have the list of friends for every user, you are ready to fetch the images that need to be shown in the timeline of a particular user. In this step, you will be using DynamoDB as your backend store. In this task, we will create a DynamoDB database and store user profile images (each person has exactly 1 profile image and is identified by his/her id) in it.</p>
  <p>Since images are usually much bigger than text dataset, the images are stored in S3 and their URLs are stored in a text dataset instead.</p>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          Name
        </th>
        <th>
          Stored In
        </th>
        <th>
          Description
        </th>
        <th>
          Location
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>images.csv</td>
      <td>DynamoDB</td>
      <td>profile images <userid, created_date,="" image_url=""></userid,></td>
      <td>s3://cloud.public/images.csv</td>
    </tr>
  </tbody></table>
  <h4>
    <small class="tcaption">
      <p>Table 6: DynamoDB Information</p>
    </small>
  </h4>
  <div class="bs-callout bs-callout-danger">
    <h4>Warning on DynamoDB costs</h4>
    <p>Amazon charges DynamoDB users based on the provisioned read and write capacities per hour. You will be charged for the provisioned capacity, irrespective of the actual number of requests that are sent to your DynamoDB table. <b>You can incur extremely high costs if you leave DynamoDB provisioned for even a few hours.</b> Calculate your costs before starting to avoid going over the project limit. Please complete all tasks in one sitting and delete the DynamoDB table once you have completed with the checkpoint.</p>
  </div>
  <h5>Setting up Amazon DynamoDB</h5>
  <ol>
    <li>
      In AWS, choose DynamoDB service from console and create a new DynamoDB table.
      <ol>
        <li>
          Set the primary key type to <b>Hash</b>.
        </li>
        <li>
          Set <b>Hash Attribute Name</b> to userid and choose type <b>Number</b> to use 
          <userid>
          as hash key.
        </userid></li>
        <li>
          Set the Read and Write capacities to 300.
        </li>
        <li>
          Note the region in which AWS creates the table.
        </li>
      </ol>
    </li>
    <li>
      Prepare <b>images.csv</b> for loading into DynamoDB.
      <p>You can directly use the import table function provided by DynamoDB. However, tables of DynamoDB is stored in a different format from CSV/TSV files, so first you need to convert images.csv into the correct format for DynamoDB. Read more about DynamoDB data format validation <a href="http://docs.aws.amazon.com/datapipeline/latest/DeveloperGuide/dp-importexport-ddb-pipelinejson-verifydata2.html">here</a>. A sample line of record is shown as below:
        <code>url\x03{"s":"https://soundrrr.s3.amazonaws.com/0000210873e35b413b322fb9971275.png"}\x02userid\x03{"n":"1"}\x02time\x03{"s":"2012-11-16"}</code>
      </p>
      <p>Find a sample for DynamoDB import at <b>/home/ubuntu/sample</b>.</p>
    </li>
    <li>
    Create a new folder on S3 and upload the processed data into it. Since you will be launching a MapReduce job to load the data into DynamoDB, the import directory should be a directory instead of a single file. In this case, the output directory is exactly your DynamoDB.  
    </li>
    <li>
      Load data with correct format into DynamoDB.
      <ol>
        <li>
          Click Export/Import in DynamoDB.
          <img src="./P3.3_files/dynamodb_tables.png" style="border: 1px solid;" width="90%" height="100%">
          <h4>
            <small class="caption">
              <p>Figure 9: DynamoDB Export/Import</p>
            </small>
          </h4>
        </li>
        <li>
          Select a table and choose <b>Import into DynamoDB</b>.
        </li>
        <li>
          Set up the import and log directory, then you need to create two IAM roles, a <b>Data Pipeline Default Role</b> and a <b>Default Resource Role</b>, to complete this task. Without the correct IAM role, the pipeline will not be able to access DynamoDB and/or S3.
          <img src="./P3.3_files/create_pipeline.png" style="border: 1px solid;" width="90%" height="50%">
          <h4>
            <small class="caption">
              <p>Figure 10: Import into DynamoDB Table</p>
            </small>
          </h4>
        </li>
        <li>
          Go to IAM in Services and choose <b>Roles</b> from the dashboard on the left.
          <ol>
            <li>
              Create a role (role1) with Role Type <b>AWS Data Pipeline</b>. Click Next Step and leave the checkbox empty.
            </li>
            <li>
              Go to Policies and choose <b>Create Policy =&gt; Create Your Own Policy</b>. Then add the following to <b>Policy Document</b>.
              <pre>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:List*",
        "s3:Put*",
        "s3:Get*",
        "s3:DeleteObject",
        "s3:CreateBucket",
        "dynamodb:DescribeTable",
        "dynamodb:Scan",
        "dynamodb:Query",
        "dynamodb:GetItem",
        "dynamodb:BatchGetItem",
        "dynamodb:UpdateTable",
        "ec2:AuthorizeSecurityGroupIngress",
        "ec2:DeleteTags",
        "ec2:Describe*",
        "ec2:CancelSpotInstanceRequests",
        "ec2:CreateSecurityGroup",
        "ec2:DeleteTags",
        "ec2:CreateTags",
        "ec2:ModifyImageAttribute",
        "ec2:ModifyInstanceAttribute",
        "ec2:RequestSpotInstances",
        "ec2:RunInstances",
        "ec2:StartInstances",
        "ec2:StopInstances",
        "ec2:TerminateInstances",
        "elasticmapreduce:*",
        "rds:DescribeDBInstances",
        "rds:DescribeDBSecurityGroups",
        "redshift:DescribeClusters",
        "redshift:DescribeClusterSecurityGroups",
        "sdb:BatchPutAttributes",
        "sdb:Select*",
        "sns:GetTopicAttributes",
        "sns:ListTopics",
        "sns:Publish",
        "sns:Subscribe",
        "sns:Unsubscribe",
        "iam:PassRole",
        "iam:ListRolePolicies",
        "iam:GetRole",
        "iam:GetRolePolicy",
        "iam:ListInstanceProfiles",
        "cloudwatch:*",
        "datapipeline:DescribeObjects",
        "datapipeline:EvaluateExpression"
      ],
      "Resource": [
        "*"
      ]
    }
  ]
}
</pre>
            </li>
            <li>Attach the policy to role1 you created just now.</li>
            <li>Select role1 in Roles, and choose Edit Trust Relationship to replace the default one with the following.
            <pre>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "",
      "Effect": "Allow",
      "Principal": {
        "Service": [
          "datapipeline.amazonaws.com",
          "elasticmapreduce.amazonaws.com"
        ]
      },
      "Action": "sts:AssumeRole"
    }
  ]
}
</pre>
            </li>
            <li>
              Create another role (role2) with Role Type <b>Amazon EC2 Role for Data Pipeline</b>, and add the following to Policy Document.
<pre>{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:*",
        "dynamodb:*",
        "ec2:Describe*",
        "elasticmapreduce:Describe*",
        "elasticmapreduce:ListInstance*",
        "elasticmapreduce:AddJobFlowSteps",
        "rds:Describe*",
        "datapipeline:*",
        "cloudwatch:*",
        "redshift:DescribeClusters",
        "redshift:DescribeClusterSecurityGroups",
        "sdb:*",
        "sns:*",
        "sqs:*"
      ],
      "Resource": [
        "*"
      ]
    }
  ]
}
</pre>
            </li>
          </ol>
      </li></ol>
    </li><li>
      Set role1 as <b>Data Pipeline Default Role</b> and role2 as <b>Default Resource Role</b> in DynamoDB <b>Create Import Table Data</b>. Then click <b>Create Import Pipeline</b> and the import should be finished in no more than 30 minutes. You can also check the progress in EMR.
      <img src="./P3.3_files/set_role.png" style="border: 1px solid;" width="90%" height="50%">
      <h4>
        <small class="caption">
          <p>Fig 10 Step 3: Set DynamoDB Role</p>
        </small>
      </h4>
    </li>
    <li>
      Connect and query DynamoDB using Amazon DynamoDB API.
      <ol>
        <li>You need your credentials to connect to DynamoDB. Use the method in Project 2 to <a href="http://docs.aws.amazon.com/AWSSdkDocsJava/latest/DeveloperGuide/credentials.html#credentials-default">import credentials/properties</a>. Do not explicitly leave your credential information in the code.</li>
        <li>Read more about DynamoDB APIs <a href="http://docs.aws.amazon.com/amazondynamodb/latest/APIReference/Welcome.html">here</a>.</li>
      </ol>
      <br>
      <h4>Request and Response of Your Server</h4>
      <h6>Request Format</h6>
      <pre>GET /step3?id=&lt;userid&gt;</pre>
      <h6>Response Value</h6>
      <pre>Return &lt;created_date&gt; and &lt;image_url&gt; of the given &lt;user_id&gt;</pre>
      <h6>Response Format</h6>
      <pre>JSONObject response = new JSONObject();
response.put("time", createdDate);
response.put("url", imageUrl);
String content = "returnRes("+mapper.writeValueAsString(response)+")";
sender.send(content);
</pre>
      <p>After completing these steps, when querying frontend with userid, a timeline with single image should be shown as below.</p>
      <img src="./P3.3_files/timeline_single_image.png" width="70%" height="50%">
      <h4>
        <small class="caption">
          <p>Figure 11 Step 3: Testing Page</p>
        </small>
      </h4>
  </li></ol>
  <h4 id="step4"><b>Step 4: Putting All Things Together (aka getting the Timeline working)</b></h4>
  <p>By now, you should have some experience with RDS, HBase, and DynamoDB. Recall that you implemented a rudimentary user authentication system in Step 1, a friend-fetch system in Step 2, and a user-profile-image-fetch system in Step 3. The last thing you need to do is to put all these together to build an image timeline. Once the user logs in with a &lt;userid&gt; and &lt;password&gt;, all the user's friends profile images should be displayed in the timeline. The structure of the web service will look as shown in Figure 12.  
  </p>
  <img src="./P3.3_files/Fig12.jpg" width="70%" height="50%">
      <h4>
        <small class="caption">
          <p>Figure 12 Step 3: Step 4 Overview</p>
        </small>
      </h4>
  <h5>Request and Response of Your Server</h5>
  <h6>Request Format</h6>
  <pre>GET /step4?id=&lt;userid&gt;&amp;pwd=&lt;password&gt;
</pre>
  <h6>Response Value</h6>
  <li>If &lt;userid&gt; and &lt;password&gt; is valid, return the name, image url and creation date of all his/her friends, ordered by date (<b>oldest photo first</b>). </li>
  <li>For images created on the same day, sorted by friends' &lt;name&gt; in <b>alphabetic order</b>
  </li><li>If &lt;userid&gt; and &lt;password&gt; is not a pair, return "Unauthorized" as the name and an empty JSONArray photos named "photos"</li>
  <h6>Response Format</h6>
  <pre>JSONObject response = new JSONObject();
JSONArray photos = new JSONArray();
JSONObject photo1 = new JSONObject();
photo1.put("url", url1);
photo1.put("time", time1);
photo1.put("name", friendname1);
photos.add(phto1);
response.put("name", name);
response.put("photos", photos);
String content = "returnRes("+mapper.writeValueAsString(response)+")";
sender.send(content);
</pre><br>
<h4>Hint</h4>
  <p>Consider this query on the frontend instance:</p>
    <pre>GET /p3-3.3/step4?id=id1&amp;pwd=pwd1&amp;dns=server-public-dns</pre>
    <p>You should see the following response</p>
<p>1.Name of user &lt;id1&gt; will be shown on the title as "USER1's Timeline" if &lt;id1&gt; and &lt;pwd1&gt; is a pair. Otherwise, show "Unauthorized"</p>
<p>2.All his friends photos should be displayed on the timeline (please refer to <b>Response Value</b> section in Step 4 for detailed rules)</p>
<p>3.Each friend's name and his/her photo's create date should be displayed on top of his photo</p><br>

  <h4>Example</h4>
  <h4>RDS</h4>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          userid
        </th>
        <th>
          password
        </th>
        <th>
          name
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>1</td>
      <td>15619p3</td>
      <td>TA</td>
    </tr>
    <tr>
      <td>20</td>
      <td>xxxxxxx</td>
      <td>Professor</td>
    </tr>
    <tr>
      <td>35</td>
      <td>xxxxxxx</td>
      <td>Student</td>
    </tr>
  </tbody></table>
  <h4>
    <small class="tcaption">
      <p>Table 7: Data in RDS</p>
    </small>
  </h4>
  <p>user 1 has 2 friends 20, 35</p>
  <h4>DynamoDB</h4>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          userid
        </th>
        <th>
          time
        </th>
        <th>
          imageUrl
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>20</td>
      <td>2014-01-02</td>
      <td>link1</td>
    </tr>
    <tr>
      <td>35</td>
      <td>2014-12-30</td>
      <td>link2</td>
    </tr>
  </tbody></table>
  <h4>
    <small class="tcaption">
      <p>Table 8: Data in DynamoDB</p>
    </small>
  </h4>
  <p>Request 1</p>
  <pre>GET /step4?id=1&amp;pwd=15619p3</pre>
  <p>Response 1</p>
  <pre>{
    "name" : "TA",
    "photos" : [
        {"name" : "Professor", "url" : link1, "time" : "2014-01-02"},
        {"name" : "Student", "url" : link2, "time" : "2014-12-30"}
    ]
};</pre>
  <p>Request 2</p>
  <pre>GET /step4?id=1&amp;pwd=wrong</pre>
  <p>Response 2</p>
  <pre>{
    "name" : "Unauthorized"
    "photos" : []
};</pre>
<img src="./P3.3_files/amy_timeline.png" width="90%" height="50%">
<h4><small class="caption"><p>Step 4</p></small></h4>
<div class="bs-docs-section">
<h1 id="grading" class="page-header">Grading</h1>
<p>Your web service (MiniSite.java) should simultaneously support all the 4 queries from step 1 to 4</p>
  <table class="table table-striped table-bordered table-condensed prettyBorder">
    <thead>
      <tr>
        <th>
          step
        </th>
        <th>
          Request
        </th>
        <th>
          Response
        </th>
      </tr>
    </thead>
    <tbody><tr>
      <td>Step1</td>
      <td>GET /step1?id=XX&amp;pwd=XXX</td>
      <td>name</td>
    </tr>
    <tr>
      <td>Step2</td>
      <td>GET /step2?id=XX</td>
      <td>friends ids</td>
    </tr>
    <tr>
      <td>Step3</td>
      <td>GET /step3?id=XX</td>
      <td>image url and create date</td>
    </tr>
    <tr>
      <td>Step4</td>
      <td>GET /step4?id=XX&amp;pwd=XXX</td>
      <td>name, all his friends' name, profile image and image's create date</td>
    </tr>
  </tbody></table>
  <h4><small class="tcaption"><p>Table 9: Queries</p></small></h4>
<p>Once you have completed all the questions, you can submit the answers to the evaluation system using the auto-grader executable <code>submitter</code> which is present in the <b>Project3_3</b> folder. 
</p><li>To be considered for a valid grade in a particular step, you must have completed all prior steps. For example, if you do not complete Step 1 and 2, you will always receive 0 in Step 3 (In other words, complete the steps in the order given).</li> 
<li><b>Keep your server running and all databases available</b> and run the executable using the command <code>./submitter</code> from the Project3_3 folder. After running this command, you should be able to see your scores on TPZ in a few minutes</li><p></p>
<p>The score distribution is as follows: </p>
<table class="table table-striped table-bordered table-condensed prettyBorder">
  <thead>
    <tr>
      <th></th>
      <th>Step1</th>
      <th>Step2</th>
      <th>Step3</th>
      <th>Step4</th>
      <th>Code</th>
    </tr>
  </thead>
  <tbody><tr>
    <td>Score (100)</td>
    <td>15</td>
    <td>20</td>
    <td>20</td>
    <td>25</td>
    <td>20</td>
  </tr>
</tbody></table>
<h4><small class="tcaption"><p>Table 10: Grading Details</p></small></h4>
</div>
</div>

<h4 id="additional-reading"><b>Additional Reading and References</b></h4>

<li><a href="http://www.read.seas.harvard.edu/~kohler/class/cs239-w08/decandia07dynamo.pdf">DeCandia, Giuseppe, et al. "Dynamo: amazon's highly available key-value store." ACM SIGOPS Operating Systems Review. Vol. 41. No. 6. ACM, 2007.</a></li>

<li><a href="http://books.google.com/books?hl=en&lr=&id=nUhiQxUXVpMC&oi=fnd&pg=PR7&dq=hbase&ots=Hgb7gTYhS6&sig=90T2dR4V_sEMQ3vCwAcfd7wrVAw#v=onepage&q=hbase&f=false">George, Lars. HBase: the definitive guide. " O'Reilly Media, Inc.", 2011.</a></li>

<div id="#penalties" class="bs-callout bs-callout-danger">
  <h4 id="project-grading-penalties">Project Grading Penalties</h4>
  <p>The following table outlines the violations of the project rules and their corresponding grade penalties for this project.</p>
  <table class="table">
    <thead>
      <tr>
        <th>Violation</th>
        <th>Penalty of the project grade</th>
      </tr>
    </thead>
    <tbody><tr>
      <td>Spending more than $20 for this project phase</td>
      <td>-10%</td>
    </tr>
    <tr>
      <td>Spending more than $40 for this project phase</td>
      <td>-100%</td>
    </tr>
    <tr>
      <td>Failing to tag all your resources for this project (Key: Project Value:3.3)</td>
      <td>-10%</td>
    </tr>
    <tr>
      <td>Not using required databases for each step</td>
      <td>-100%</td>
    </tr>
    <tr>
      <td>Submitting your AWS credentials in your code for grading</td>
      <td>-10%</td>
    </tr>
  </tbody></table>
</div>

<p></p></div>
<!-- JS Scripts -->
<script src="./P3.3_files/docs.min.js"></script>
<p></p>


    </div>


    </div>

    <div id="footer" class="navbar-fixed-bottom" style="height:30px;background-color:#f5f5f5;position:fixed;bottom:0;width:100%;text-align:center;padding:5px">
        <p class="text-muted credit">©2015 Teaching Staff Of The Cloud Computing Course, Carnegie Mellon University</p>
    </div>

    
    
    

    <script type="text/javascript">
        function dashIfUNE(str) {
            return (str==null || str.length===0)?'<span class="glyphicon glyphicon-minus"></span>':str;
        }
        /* https://docs.djangoproject.com/en/dev/ref/csrf/ */
        function csrfSafeMethod(method) {
            return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
        }
        $.ajaxSetup({
            beforeSend: function(xhr, settings) {
                if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
                    xhr.setRequestHeader("X-CSRFToken", csrftoken);
                }
            }
        });
        function getCookie(name) {
            var cookieValue = null;
            if (document.cookie && document.cookie != '') {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = jQuery.trim(cookies[i]);
                    if (cookie.substring(0, name.length + 1) == (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
        var csrftoken = getCookie('csrftoken');
    </script>
    
    <script type="text/javascript">
        function fixNavbarTop() {
            $('#base-container').css('padding-top', $('.navbar-fixed-top').height()+10);
        }
        $(document).ready(fixNavbarTop);
        $(window).resize(fixNavbarTop);
        $(window).load(fixNavbarTop);
    </script>

    <script type="text/javascript">
        $(document).ready(function(){
            $('#nav_writeup').addClass('btn-primary');
            $("#project3").addClass('active');
        });
    </script>



</div></body></html>